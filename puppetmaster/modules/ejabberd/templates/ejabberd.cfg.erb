%% reset all configuration.
override_global.
override_local.
override_acls.

%% basic config.
{language, "en"}.
{loglevel, 4}.

%% only allow 1000 packets to be queued for every outgoing connection
{max_fsm_queue, 1000}.

%% authentication
{auth_method, external}.
{extauth_program, "/etc/ejabberd/auth_all"}.

%% enabled hosts
{hosts,  ["aerofs.com"]}.
{listen,
 [
  {<%= @port %>, ejabberd_c2s, [
			{access, c2s},
			{max_stanza_size, 65536},
                        %%zlib,
			starttls, {certfile, "/etc/ejabberd/ejabberd.pem"}
		       ]}
 ]}.

%% db setup
{odbc_server, {mysql, "<%= @mysql_host %>", "<%= @mysql_db %>", "<%= @mysql_user %>", "<%= @mysql_password %>"}}.

%% local users: don't modify this line.
{acl, local, {user_regexp, ""}}.

%% define the maximum number of time a single user is allowed to connect:
{access, max_user_sessions, [{10, all}]}.

%% only non-blocked users can use c2s connections:
{access, c2s, [{deny, blocked}, {allow, all}]}.

%% all users are allowed to use MUC service:
{access, muc, [{allow, all}]}.

%% allow in-band registration
{access, register, [{allow, all}]}.

%% By default frequency of account registrations from the same IP
%% is limited to 1 account every 10 minutes. To disable put: infinity
{registration_timeout, infinity}.

%% enabled modules
{modules,
 [
  {mod_ping,     []},
  {mod_disco,    []},
  {mod_muc,      [
		  {host, "c.@HOST@"},
		  {access, muc},
		  {access_create, muc},
		  {access_persistent, muc},
		  {max_user_conferences, 50000},
		  {default_room_options, [
	            {persistent, true},
	            {public, true},
	            {public_list, true},
	            {logging, false}
	          ]}
		 ]}
 ]}.

%%% Local Variables:
%%% mode: erlang
%%% End:
%%% vim: set filetype=erlang tabstop=8:
