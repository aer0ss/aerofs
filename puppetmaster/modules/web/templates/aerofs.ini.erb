[uwsgi]
virtualenv = /opt/web/pythonenv
wsgi-file = /opt/web/production.wsgi
socket = :<%= @uwsgi_port %>
master = true

# We need this because we have big cookies
# We have big cookies because we use mixpanel, optimizely, etc.
# along with our own beaker encrypted blob
buffer-size = 8192

# Set these based on capacity of server, but because some of
# our code is stateful (namely in-memory session storage) more
# processes could cause problems
processes = 1
listen = 256

chdir = /opt/web
plugins = python
single-interpreter = true

# harakiri settings (kills requests taking longer than 30s
# and rogue workers)
harakiri = 30
harakiri-verbose = true
post-buffering = 32768
reload-on-as = 256
reload-on-rss = 128
no-orphans = true
env = STRIPE_PUBLISHABLE_KEY=<%= @STRIPE_PUBLISHABLE_KEY %>
env = STRIPE_SECRET_KEY=<%= @STRIPE_SECRET_KEY %>
