<!--
    Resource declaration for database connection pool.
    See http://commons.apache.org/dbcp/configuration.html for more configuration options for
    the connection pool and
    http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html
    for more possible connectionProperties.
-->
<% @databases.each do |database| -%>
    <Resource name="jdbc/<%= database["name"] %>"
              auth="Container"
              type="javax.sql.DataSource"

              username="<%= database["user"] %>"
              password="<%= database["password"] %>"

              driverClassName="com.mysql.jdbc.Driver"

              url="jdbc:mysql://<%= database["endpoint"] %>/<%= database["schema"] %>"

              maxActive="8"
              maxIdle="4"
              removeAbandoned="true"
              removeAbandonedTimeout="30"

              connectionProperties="cachePrepStmts=true; autoReconnect=true; useUnicode=true;
                    characterEncoding=utf8;"
    />
<% end -%>
</Context>
