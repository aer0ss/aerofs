#!/bin/bash
set -eu

###############################################################################
#
# General includes
#
###############################################################################
include include/common ${1:-} ${2:-}

###############################################################################
#
# usage and parameters
#
###############################################################################
if [[ $# -lt 1 || $# -gt 2 ]]; then
    echo "usage: $0 [build mode] [build product]" >&2
    echo " " >&2
    echo "[build mode]: PROD|ENTERPRISE" >&2
    echo "[build product]: CLIENT|TEAM_SERVER" >&2
    echo " " >&2
    echo "example: $0 PROD TEAM_SERVER" >&2
    echo "example: $0 ENTERPRISE CLIENT" >&2
    exit $ERRBADARGS
fi

#******************************************************************************
#******************************************************************************
#**
#** Run all of the build steps
#**
#******************************************************************************
#******************************************************************************

compute_next_release_version
echo '+---------------------------------'
echo '| ' $RELEASE_VERSION $PRODUCT $MODE
echo '+---------------------------------'

call make_release_resources $MODE $PRODUCT $RELEASE_VERSION
call make_client_installers $MODE $PRODUCT $RELEASE_VERSION
echo ">> successfully built $MODE $PRODUCT release version $RELEASE_VERSION"
exit 0
