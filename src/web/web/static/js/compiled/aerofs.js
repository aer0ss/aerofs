function nltobr(message){return message.replace(/\n/g,"<br>")}function escapify(message){$("body").append('<div id="dummy-node" style="display: none;"></div>');var node=$("#dummy-node");var escaped_message=node.text(message).html();node.remove();return escaped_message}function showErrorMessageUnnormalizedUnsafe(message){hideAllMessages();$("#flash-msg-error-body").html(message);$("#flash-msg-error").fadeIn()}function showErrorMessageUnsafe(message){showErrorMessageUnnormalizedUnsafe(normalizeMessage(message))}function showErrorMessageUnnormalized(message){showErrorMessageUnnormalizedUnsafe(nltobr(escapify(message)))}function showErrorMessage(message){showErrorMessageUnnormalized(normalizeMessage(message))}var successMessageTimer;function showSuccessMessageUnsafe(message){hideAllMessages();var $msg=$("#flash-msg-success");$msg.html(normalizeMessage(message));$msg.fadeIn();successMessageTimer=window.setTimeout(function(){$msg.fadeOut()},8e3)}function showSuccessMessage(message){showSuccessMessageUnsafe(nltobr(escapify(message)))}function hideAllMessages(){$("#flash-msg-success").hide(0);$("#flash-msg-error").hide(0);if(successMessageTimer)window.clearTimeout(successMessageTimer)}$(document).ready(function(){$("div.modal").on("shown",hideAllMessages);$("div.modal").on("show",hideAllModalsExceptThis)});function fadeOutErrorMessage(){$("#flash-msg-error").fadeOut()}function normalizeMessage(message){message=message.charAt(0).toUpperCase()+message.slice(1);var last=message.slice(-1);if(last!="."&&last!="?"&&last!="!"){message+="."}return message}function showErrorMessageFromResponse(xhr){if(xhr.status==400){showErrorMessage(getAeroFSErrorMessage(xhr))}else if(xhr.status==403){window.location.assign("/login?next="+encodeURIComponent(window.location.pathname+window.location.search+window.location.hash))}else{showErrorMessageUnsafe(getInternalErrorText());console.log("show error message. status: "+xhr.status+" statusText: "+xhr.statusText+" responseText: "+xhr.responseText)}}function getInternalErrorText(){return"Sorry! An error has occurred. Please refresh"+" this page and try again. If this issue persists contact"+" <a href='mailto:support@aerofs.com' target='_blank'>"+"support@aerofs.com</a> for assistance."}function getClientsOfflineErrorText(){return"All AeroFS clients are offline. Please make sure at least one AeroFS desktop client or Team Server is"+" online and <a href='https://support.aerofs.com/hc/en-us/articles/201438954' target='_blank'>"+"has API access enabled</a>."}function getErrorTypeNullable(xhr){return xhr.status==400?$.parseJSON(xhr.responseText).type:null}function getAeroFSErrorMessage(xhr){return $.parseJSON(xhr.responseText).message}function getAeroFSErrorData(xhr){return $.parseJSON(xhr.responseText).data}function setVisible($elem,visible){if(visible)$elem.removeClass("hidden");else $elem.addClass("hidden");return $elem}function setEnabled($elem,enabled){if(enabled)$elem.removeAttr("disabled").removeClass("disabled");else $elem.attr("disabled","disabled").addClass("disabled");return $elem}function disableEsapingFromModal($modal){$modal.modal({backdrop:"static",keyboard:false,show:false})}function hideAllModals(){$("div.modal").modal("hide")}function hideAllModalsExceptThis(){$("div.modal").not(this).modal("hide")}$.extend({postJSON:function(url,data){return $.ajax({type:"POST",url:url,data:JSON.stringify(data),dataType:"json",contentType:"application/json; charset=utf-8",processData:false})}});