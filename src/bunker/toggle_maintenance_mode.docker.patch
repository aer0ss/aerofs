@@ -2,8 +2,7 @@
 <%! page_title = "Backup" %>
 
 <%namespace name="progress_modal" file="progress_modal.mako"/>
-<%namespace name="common" file="backup_common.mako"/>
-<%namespace name="bootstrap" file="bootstrap.mako"/>
+<%namespace name="loader" file="loader.mako"/>
 <%namespace name="spinner" file="spinner.mako"/>
 
 <h2>
@@ -54,7 +53,7 @@
     <%progress_modal:scripts/>
     ## spinner support is required by progress_modal
     <%spinner:scripts/>
-    <%bootstrap:scripts/>
+    <%loader:scripts/>
 
     <script>
         $(document).ready(function() {
@@ -64,18 +63,19 @@
         function enterOrExitMaintenance() {
             $('#${progress_modal.id()}').modal('show');
 
-            var task =
+            var target =
                 %if is_maintenance_mode:
-                    'maintenance-exit';
+                    'default';
                 %else:
-                    'maintenance-enter';
+                    'maintenance';
                 %endif
 
-            runBootstrapTask(task, function() {
+            reboot('current', 'current', target, function() {
                 ## reload the page to refresh the value of is_maintenance_mode.
                 location.reload();
-            }, function() {
+            }, function(xhr) {
                 $('#${progress_modal.id()}').modal('hide');
+                showErrorMessageFromResponse(xhr);
             });
         }
     </script>
