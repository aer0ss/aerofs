#!/bin/bash -e

echo "WARNING: this will cause all clients to resend sync status information!"
echo -n "Continue [y/n]? "

read answer
if [ "$answer" != "y" ]
then
    echo "Abort."
    exit 1
fi

echo ">>> Stopping web services to avoid inconsistency..."
service nginx stop || true
service tomcat6 stop || true

echo ">>> Reset redis database..."
redis-cli flushall

echo ">>> Restart web services..."
service tomcat6 start
service nginx start

echo "DONE."
